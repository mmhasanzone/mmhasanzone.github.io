<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Right Form of Verb Rules & Practice</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --bg-color: #f5f6fa;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background-color: var(--bg-color);
            color: var(--primary-color);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px 0;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .rules {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .rule {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border-left: 5px solid var(--secondary-color);
        }

        .rule:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .rule strong {
            color: var(--secondary-color);
            font-size: 1.2em;
            display: block;
            margin-bottom: 8px;
        }

        /* Exam Section Styles */
        .exam-section {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            margin-top: 40px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
        }

        .exam-section h2 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .question {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .question h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .option {
            background-color: white;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .option:hover {
            background-color: #f0f0f0;
            border-color: var(--secondary-color);
        }

        .selected {
            background-color: var(--secondary-color);
            color: white;
            border-color: var(--secondary-color);
        }

        .correct {
            background-color: #2ecc71;
            color: white;
            border-color: #27ae60;
        }

        .wrong {
            background-color: var(--accent-color);
            color: white;
            border-color: #c0392b;
        }

        .btn {
            display: block;
            width: 200px;
            margin: 20px auto;
            padding: 15px 30px;
            background: linear-gradient(135deg, var(--secondary-color), #2980b9);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            text-transform: uppercase;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        #loadingIndicator {
            display: none;
            text-align: center;
            margin: 20px 0;
        }

        .loading #loadingIndicator {
            display: block;
        }

        .result {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            font-size: 1.3em;
            font-weight: bold;
            color: var(--primary-color);
            background-color: #f8f9fa;
            border-radius: 8px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .rules {
                grid-template-columns: 1fr;
            }
            
            .options {
                grid-template-columns: 1fr;
            }

            .rule {
                margin: 10px;
            }

            h1 {
                font-size: 2em;
            }
        }

        /* Floating buttons common styles */
        .floating-button {
            position: fixed;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            color: white;
            text-decoration: none;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            z-index: 1000;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .floating-button:hover {
            background-color: rgba(0, 0, 0, 0.7);
            transform: scale(1.1);
            box-shadow: 0 3px 8px rgba(0,0,0,0.3);
        }

        /* Home button specific */
        .floating-home {
            bottom: 20px;
        }

        /* Scroll button specific */
        .floating-scroll {
            bottom: 90px;
        }

        .floating-scroll i {
            font-size: 24px;
            transition: transform 0.3s ease;
        }

        .floating-scroll.at-bottom i {
            transform: rotate(180deg);
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
    <div class="floating-button floating-scroll" id="scrollButton" title="Scroll to Top/Bottom">
        <i class="fas fa-arrow-down"></i>
    </div>
    <a href="index.html" class="floating-button floating-home" title="Go to Home">
        <i class="fas fa-home"></i>
    </a>
    <header>
        <div class="container">
            <h1>Right Form of Verb Rules & Practice</h1>
        </div>
    </header>

    <div class="container">
        <div class="rules">
        <div class="rule"><strong>1.</strong> 3rd Person Singular subject-‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá verb-‡¶è‡¶∞ s/es ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡•§ (He plays football.)</div>
        <div class="rule"><strong>2.</strong> Past simple tense-‡¶è verb-‡¶è‡¶∞ past form ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡ßü‡•§ (They went home.)</div>
        <div class="rule"><strong>3.</strong> Future simple tense-‡¶è will/shall + base form ‡¶π‡ßü‡•§ (She will dance tomorrow.)</div>
        <div class="rule"><strong>4.</strong> Auxiliary verb (is/am/are/was/were) + verb-‡¶è‡¶∞ ing form ‡¶π‡ßü‡•§ (She is singing now.)</div>
        <div class="rule"><strong>5.</strong> Have verb (has/have/had) + past participle ‡¶π‡ßü‡•§ (They have finished the work.)</div>
        <div class="rule"><strong>6.</strong> Modal verb (can, may, must, should) + base form ‡¶π‡ßü‡•§ (You should study more.)</div>
        <div class="rule"><strong>7.</strong> Preposition-‡¶è‡¶∞ ‡¶™‡¶∞ Gerund (verb + ing) ‡¶π‡ßü‡•§ (He is good at singing.)</div>
        <div class="rule"><strong>8.</strong> Causative Verbs (Make, Let, Have, Get) ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ verb-‡¶è‡¶∞ ‡¶∞‡ßÇ‡¶™ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>9.</strong> Need ‡¶è‡¶¨‡¶Ç Dare modal verb ‡¶π‡¶≤‡ßá ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ verb-‡¶è‡¶∞ base form ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>10.</strong> Would Rather / Had Better + Base Form ‡¶π‡ßü‡•§ (I would rather stay home.)</div>
        <div class="rule"><strong>11.</strong> It‚Äôs High Time + Past Verb ‡¶π‡ßü‡•§ (It‚Äôs high time you started studying.)</div>
        <div class="rule"><strong>12.</strong> Wish ‡¶è‡¶¨‡¶Ç If Only-‡¶è‡¶∞ ‡¶™‡¶∞ Past Tense ‡¶π‡ßü‡•§ (I wish I were a bird.)</div>
        <div class="rule"><strong>13.</strong> Would You Mind + Verb + ing ‡¶π‡ßü‡•§ (Would you mind helping me?)</div>
        <div class="rule"><strong>14.</strong> As If / As Though + Past Tense ‡¶π‡ßü‡•§ (He talks as if he knew everything.)</div>
        <div class="rule"><strong>15.</strong> Passive Voice-‡¶è Modal Verb + be + Past Participle ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>16.</strong> Neither...nor / Either...or ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ verb ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>17.</strong> Every, Each, Either, Neither, Someone, Nobody-‡¶è‡¶∞ ‡¶™‡¶∞ Singular Verb ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>18.</strong> Since / For-‡¶è‡¶∞ ‡¶™‡¶∞ Present Perfect ‡¶¨‡¶æ Present Perfect Continuous Tense ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>19.</strong> Would That + Subject + Could/Would + Base Form ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>20.</strong> Let‚Äôs, Let Us-‡¶è‡¶∞ ‡¶™‡¶∞ Base Form ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>21.</strong> Hardly/Scarcely... when ‡¶è‡¶¨‡¶Ç No sooner... than-‡¶è‡¶∞ ‡¶™‡¶∞ Past Perfect ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>22.</strong> Lest-‡¶è‡¶∞ ‡¶™‡¶∞ Should + Base Form ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>23.</strong> Despite/In spite of-‡¶è‡¶∞ ‡¶™‡¶∞ Gerund ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>24.</strong> Superlative Degree-‡¶è‡¶∞ ‡¶™‡¶∞ Present Perfect Tense ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>25.</strong> Could / Might / Should / Would Have + Past Participle ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>26.</strong> It is time + Past Tense ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>27.</strong> Too... to + Base Form ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>28.</strong> Be + Used to + Gerund ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>29.</strong> Would You Like + To + Base Form ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>30.</strong> As Well As / Along With / Together With / With / Accompanied By-‡¶è‡¶∞ ‡¶™‡¶∞ Singular Verb ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>31.</strong> One of + Plural Noun + Singular Verb ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>32.</strong> More Than One + Singular Noun + Singular Verb ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>33.</strong> There is / There are ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ verb ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>34.</strong> As Soon As-‡¶è‡¶∞ ‡¶™‡¶∞ Present Simple ‡¶π‡¶≤‡ßá, ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶Ö‡¶Ç‡¶∂ Future Tense ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>35.</strong> Prefer / Preferable-‡¶è‡¶∞ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡•§</div>
        <div class="rule"><strong>36.</strong> Found / Catch / See / Hear / Watch + Object + Verb + ing ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>37.</strong> Advice / Suggest-‡¶è‡¶∞ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡•§</div>
        <div class="rule"><strong>38.</strong> Hardly / Scarcely... When ‡¶è‡¶¨‡¶Ç No Sooner... Than-‡¶è‡¶∞ ‡¶™‡¶∞ Past Perfect ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>39.</strong> On + Verb + ing (On seeing, On hearing) ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>40.</strong> Possessive Pronoun-‡¶è‡¶∞ ‡¶™‡¶∞ Gerund ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>41.</strong> The number of + Singular Verb ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>42.</strong> A number of + Plural Verb ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>43.</strong> Many a + Singular Noun + Singular Verb ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>44.</strong> If-Clause Type 1: Present Simple + Future Simple ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>45.</strong> If-Clause Type 2: Past Simple + Would/Could + Base Form ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>46.</strong> If-Clause Type 3: Past Perfect + Would Have + Past Participle ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>47.</strong> While + Past Continuous ‡¶π‡¶≤‡ßá, ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶Ö‡¶Ç‡¶∂‡¶ü‡¶ø Past Simple ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>48.</strong> Before-‡¶è‡¶∞ ‡¶™‡¶∞ Past Perfect ‡¶π‡¶≤‡ßá, ‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶¨‡¶æ‡¶ï‡ßç‡¶Ø‡ßá Past Simple ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>49.</strong> Until / Till-‡¶è‡¶∞ ‡¶™‡¶∞ Negative Meaning ‡¶•‡¶æ‡¶ï‡¶≤‡ßá Affirmative Verb ‡¶π‡ßü‡•§</div>
        <div class="rule"><strong>50.</strong> Would Prefer + To + Base Form ‡¶π‡ßü‡•§</div>
    </div>

    <section class="exam-section">
        <h2>Practice Your Knowledge</h2>
        <div id="questionContainer"></div>
        <div id="loadingIndicator">
            <p style="color: #3498db; font-weight: bold;">‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶ö‡ßç‡¶õ‡ßá... ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
        </div>
        <button class="btn" id="startExam">Start Practice</button>
        <div class="result" id="result"></div>
    </section>
</div>

<script>
    const GEMINI_API_KEY = 'AIzaSyB6_Fz6KVZddc_Rjs3Yi_W-fV5Q73tPzRU';
    const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent';

    async function generateQuestions() {
        try {
            const response = await axios.post(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                contents: [{
                    parts: [{
                        text: `Generate 5 English grammar practice questions about right form of verbs. Return the response in this exact JSON format:
                        [
                            {
                                "question": "He _____ (work) in this company since 2020.",
                                "options": ["works", "has been working", "is working", "worked"],
                                "correct": 1,
                                "explanation": "Rule 5: Present Perfect Continuous - ‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶æ‡¶ú ‡¶Ö‡¶§‡ßÄ‡¶§‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶Ø‡¶º‡ßá ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá‡¶ì ‡¶ö‡¶≤‡¶õ‡ßá ‡¶¨‡ßã‡¶ù‡¶æ‡¶§‡ßá Present Perfect Continuous ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡¶Ø‡¶º‡•§ 'Since' ‡¶è‡¶∞ ‡¶™‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶¨‡ßã‡¶ù‡¶æ‡¶Ø‡¶º‡•§"
                            }
                        ]

                        Rules:
                        1. Question must be in English
                        2. Each question must test a specific grammar rule from the 50 rules shown in the page
                        3. Explanation must be in Bengali and must start with the rule number
                        4. Each question must have exactly 4 options
                        5. The correct answer index must be 0-3
                        6. The response must be a valid JSON array
                        7. Do not include any additional text or formatting`
                    }]
                }]
            });

            const text = response.data.candidates[0].content.parts[0].text;
            console.log('Raw response:', text);

            // Try to find JSON array in the response
            const jsonMatch = text.match(/\[\s*\{[\s\S]*\}\s*\]/);
            if (!jsonMatch) {
                console.warn("No JSON array found in response");
                return questionBank.sort(() => Math.random() - 0.5).slice(0, 5);
            }

            let generatedQuestions;
            try {
                generatedQuestions = JSON.parse(jsonMatch[0]);

                // Validate the questions format
                if (!Array.isArray(generatedQuestions) || generatedQuestions.length === 0) {
                    throw new Error("Invalid questions format");
                }

                // Validate each question
                generatedQuestions = generatedQuestions.filter(q => 
                    q.question && 
                    Array.isArray(q.options) && 
                    q.options.length === 4 &&
                    typeof q.correct === 'number' &&
                    q.correct >= 0 && 
                    q.correct <= 3 &&
                    typeof q.explanation === 'string'
                );

                if (generatedQuestions.length === 0) {
                    throw new Error("No valid questions after filtering");
                }

            } catch (jsonError) {
                console.warn("Error parsing or validating questions:", jsonError);
                return questionBank.sort(() => Math.random() - 0.5).slice(0, 5);
            }

            // Take only 5 questions and add metadata
            return generatedQuestions.slice(0, 5).map((q, i) => ({
                ...q,
                id: `${Date.now()}-${i}-${Math.random().toString(36).substr(2, 9)}`,
                timestamp: Date.now(),
                questionNumber: i + 1,
                answered: false
            }));

        } catch (error) {
            console.error('Error generating questions:', error);
            return questionBank.sort(() => Math.random() - 0.5).slice(0, 5);
        }
    }

    let questionBank = [
        {
            question: "He _____ (work) in this company since 2020.",
            options: ["works", "has been working", "is working", "worked"],
            correct: 1,
            explanation: "Rule 5: Present Perfect Continuous - ‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶æ‡¶ú ‡¶Ö‡¶§‡ßÄ‡¶§‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶Ø‡¶º‡ßá ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá‡¶ì ‡¶ö‡¶≤‡¶õ‡ßá ‡¶¨‡ßã‡¶ù‡¶æ‡¶§‡ßá Present Perfect Continuous ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡¶Ø‡¶º‡•§ 'Since' ‡¶è‡¶∞ ‡¶™‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶¨‡ßã‡¶ù‡¶æ‡¶Ø‡¶º‡•§"
        },
        {
            question: "When I called him, he _____ (sleep).",
            options: ["slept", "was sleeping", "has slept", "sleeps"],
            correct: 1,
            explanation: "Rule 47: Past Continuous with Simple Past - ‡¶Ø‡¶ñ‡¶® ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ï‡¶æ‡¶ú ‡¶ö‡¶≤‡¶æ‡¶ï‡¶æ‡¶≤‡ßÄ‡¶® ‡¶Ü‡¶∞‡ßá‡¶ï‡¶ü‡¶ø ‡¶ï‡¶æ‡¶ú ‡¶π‡¶Ø‡¶º, ‡¶§‡¶ñ‡¶® ‡¶ö‡¶≤‡¶Æ‡¶æ‡¶® ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø Past Continuous ‡¶è‡¶¨‡¶Ç ‡¶Æ‡¶æ‡¶ù‡ßá ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø Simple Past ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "If it _____ (rain) tomorrow, I will stay home.",
            options: ["rains", "will rain", "rained", "is raining"],
            correct: 0,
            explanation: "Rule 44: First Conditional - ‡¶¨‡¶æ‡¶∏‡ßç‡¶§‡¶¨ ‡¶≠‡¶¨‡¶ø‡¶∑‡ßç‡¶Ø‡ßé ‡¶∏‡¶Æ‡ßç‡¶≠‡¶æ‡¶¨‡¶®‡¶æ ‡¶¨‡ßã‡¶ù‡¶æ‡¶§‡ßá If clause-‡¶è Present Simple ‡¶è‡¶¨‡¶Ç Main clause-‡¶è will + base form ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "The report _____ (submit) by Friday.",
            options: ["will be submitted", "will submit", "is submitting", "submits"],
            correct: 0,
            explanation: "Rule 15: Future Passive Voice - ‡¶≠‡¶¨‡¶ø‡¶∑‡ßç‡¶Ø‡¶§‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶æ‡¶ú Passive-‡¶è ‡¶¨‡ßã‡¶ù‡¶æ‡¶§‡ßá will be + Past Participle ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "She usually _____ (go) to school by bus.",
            options: ["goes", "go", "is going", "went"],
            correct: 0,
            explanation: "Rule 1: Present Simple with Third Person Singular - ‡¶®‡¶ø‡¶Ø‡¶º‡¶Æ‡¶ø‡¶§ ‡¶ï‡¶æ‡¶ú ‡¶¨‡ßã‡¶ù‡¶æ‡¶§‡ßá Third Person Singular (he/she/it) ‡¶è‡¶∞ ‡¶ï‡ßç‡¶∑‡ßá‡¶§‡ßç‡¶∞‡ßá verb ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá s/es ‡¶Ø‡ßã‡¶ó ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "They _____ to school yesterday.",
            options: ["go", "goes", "went", "gone"],
            correct: 2,
            explanation: "Rule 2: Past simple tense-‡¶è verb-‡¶è‡¶∞ past form ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "She _____ a song now.",
            options: ["sing", "sings", "is singing", "sung"],
            correct: 2,
            explanation: "Rule 4: Auxiliary verb (is/am/are) + verb-‡¶è‡¶∞ ing form ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "I _____ my homework already.",
            options: ["do", "did", "have done", "doing"],
            correct: 2,
            explanation: "Rule 5: Have verb (has/have/had) + past participle ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "You _____ study hard.",
            options: ["must", "must to", "musting", "must be"],
            correct: 0,
            explanation: "Rule 6: Modal verb (can, may, must, should) + base form ‡¶π‡¶Ø‡¶º‡•§"
        },
        // Difficult Questions
        {
            question: "If I _____ rich, I would help the poor.",
            options: ["am", "were", "was", "had been"],
            correct: 1,
            explanation: "Rule 45: If-Clause Type 2: Past Simple + Would/Could + Base Form ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "No sooner _____ I reached home than it started raining.",
            options: ["had", "have", "has", "having"],
            correct: 0,
            explanation: "Rule 38: Hardly / Scarcely... When ‡¶è‡¶¨‡¶Ç No Sooner... Than-‡¶è‡¶∞ ‡¶™‡¶∞ Past Perfect ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "He talks as if he _____ everything.",
            options: ["knows", "knew", "has known", "had known"],
            correct: 1,
            explanation: "Rule 14: As If / As Though + Past Tense ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "It's high time you _____ studying.",
            options: ["start", "started", "starting", "starts"],
            correct: 1,
            explanation: "Rule 11: It's High Time + Past Verb ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "Despite _____ hard, he failed.",
            options: ["work", "works", "working", "worked"],
            correct: 2,
            explanation: "Rule 23: Despite/In spite of-‡¶è‡¶∞ ‡¶™‡¶∞ Gerund ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "Neither the boys nor the girl _____ present.",
            options: ["is", "are", "was", "were"],
            correct: 0,
            explanation: "Rule 16: Neither...nor / Either...or ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ verb ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "One of the students _____ absent today.",
            options: ["is", "are", "was", "were"],
            correct: 0,
            explanation: "Rule 31: One of + Plural Noun + Singular Verb ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "The number of students _____ increased.",
            options: ["has", "have", "had", "having"],
            correct: 0,
            explanation: "Rule 41: The number of + Singular Verb ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "Many a student _____ failed.",
            options: ["has", "have", "had", "having"],
            correct: 0,
            explanation: "Rule 43: Many a + Singular Noun + Singular Verb ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "Would you mind _____ the door?",
            options: ["close", "to close", "closing", "closed"],
            correct: 2,
            explanation: "Rule 13: Would You Mind + Verb + ing ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "I wish I _____ a bird.",
            options: ["am", "was", "were", "had been"],
            correct: 2,
            explanation: "Rule 12: Wish ‡¶è‡¶¨‡¶Ç If Only-‡¶è‡¶∞ ‡¶™‡¶∞ Past Tense ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "He caught her _____ his phone.",
            options: ["use", "to use", "using", "used"],
            correct: 2,
            explanation: "Rule 36: Found / Catch / See / Hear / Watch + Object + Verb + ing ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "On _____ the news, she started crying.",
            options: ["hear", "heard", "hearing", "to hear"],
            correct: 2,
            explanation: "Rule 39: On + Verb + ing (On seeing, On hearing) ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "Before he _____ the station, the train had left.",
            options: ["reach", "reaches", "reached", "had reached"],
            correct: 2,
            explanation: "Rule 48: Before-‡¶è‡¶∞ ‡¶™‡¶∞ Past Perfect ‡¶π‡¶≤‡ßá, ‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶¨‡¶æ‡¶ï‡ßç‡¶Ø‡ßá Past Simple ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
            question: "While she _____ TV, the power went off.",
            options: ["watch", "watches", "was watching", "watched"],
            correct: 2,
            explanation: "Rule 47: While + Past Continuous ‡¶π‡¶≤‡ßá, ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶Ö‡¶Ç‡¶∂‡¶ü‡¶ø Past Simple ‡¶π‡¶Ø‡¶º‡•§"
        }
    ];

    let questions = []; // questions array declare kora holo
    let currentQuestion = 0;
    let score = 0;
    let examStarted = false;

    const startBtn = document.getElementById('startExam');
    const questionContainer = document.getElementById('questionContainer');
    const resultDiv = document.getElementById('result');

    startBtn.addEventListener('click', () => {
        if (!examStarted) {
            startExam();
        } else {
            resetExam();
        }
    });

    async function startExam() {
        examStarted = true;
        currentQuestion = 0;
        score = 0;
        startBtn.textContent = 'Reset Practice';
        startBtn.disabled = true;
        questionContainer.parentElement.classList.add('loading');

        try {
            const generatedQuestions = await generateQuestions();
            questions = generatedQuestions; // Store generated questions
            showQuestion();
        } catch (error) {
            console.error('Error starting exam:', error);
            questions = []; // Handle error: Set questions to empty array
            showQuestion(); // Call showQuestion to display an error message or handle empty questions
        } finally {
            startBtn.disabled = false;
            questionContainer.parentElement.classList.remove('loading');
        }
    }
   
    function resetExam() {
        examStarted = false;
        questionContainer.innerHTML = '';
        resultDiv.textContent = '';
        startBtn.textContent = 'Start Practice';
    }

    function showQuestion() {
        if (currentQuestion >= questions.length) {
            showResult();
            return;
        }

        const q = questions[currentQuestion];
        questionContainer.innerHTML = `
            <div class="question">
                <h3>Question ${currentQuestion + 1}/${questions.length}</h3>
                <p>${q.question}</p>
                <div class="options">
                    ${q.options.map((opt, idx) => `
                        <div class="option" onclick="checkAnswer(${idx})">${opt}</div>
                    `).join('')}
                </div>
            </div>
        `;
    }

    function checkAnswer(selected) {
        if (questions[currentQuestion].answered) return;
        
        const q = questions[currentQuestion];
        const options = document.querySelectorAll('.option');
        
        options.forEach(opt => opt.style.pointerEvents = 'none');
        
        if (selected === q.correct) {
            options[selected].classList.add('correct');
            score++;
        } else {
            options[selected].classList.add('wrong');
            options[q.correct].classList.add('correct');
        }

        // Mark question as answered
        questions[currentQuestion].answered = true;

        // Show explanation and next button
        questionContainer.innerHTML += `
            <div style="margin-top: 15px; padding: 10px; background: #f0f0f0; border-radius: 5px;">
                <strong>‡¶¨‡ßç‡¶Ø‡¶æ‡¶ñ‡ßç‡¶Ø‡¶æ:</strong> ${q.explanation}
            </div>
            ${currentQuestion < questions.length - 1 ? `
                <button onclick="nextQuestion()" class="btn" style="margin-top: 15px;">Next Question</button>
            ` : `
                <button onclick="showResult()" class="btn" style="margin-top: 15px;">Show Result</button>
            `}
        `;
    }

    function nextQuestion() {
        currentQuestion++;
        showQuestion();
    }

    function showResult() {
        const percentage = (score / questions.length) * 100;
        resultDiv.innerHTML = `
            <div style="background: ${percentage >= 80 ? '#2ecc71' : percentage >= 60 ? '#f1c40f' : '#e74c3c'}; 
                 color: white; 
                 padding: 20px; 
                 border-radius: 10px;
                 box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                <h3>Your Score: ${score}/${questions.length} (${percentage}%)</h3>
                <p>${percentage >= 80 ? 'üéâ Excellent! You have mastered the rules!' : 
                     percentage >= 60 ? 'üëç Good job! Keep practicing!' : 
                     'üìö Keep learning! Practice makes perfect!'}</p>
            </div>
        `;
    }

    // Add scroll button functionality
    const scrollButton = document.getElementById('scrollButton');
    let isAtBottom = false;

    scrollButton.addEventListener('click', function() {
        if (isAtBottom) {
            // Scroll to top
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
            isAtBottom = false;
            this.classList.remove('at-bottom');
        } else {
            // Scroll to bottom
            window.scrollTo({
                top: document.documentElement.scrollHeight,
                behavior: 'smooth'
            });
            isAtBottom = true;
            this.classList.add('at-bottom');
        }
    });

    // Update button state based on scroll position
    window.addEventListener('scroll', function() {
        const scrollPosition = window.scrollY;
        const maxScroll = document.documentElement.scrollHeight - window.innerHeight;
        
        if (scrollPosition === 0) {
            // At top
            isAtBottom = false;
            scrollButton.classList.remove('at-bottom');
        } else if (scrollPosition >= maxScroll - 10) {
            // At bottom (with small threshold)
            isAtBottom = true;
            scrollButton.classList.add('at-bottom');
        }
    });
</script>
